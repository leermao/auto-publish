type: function
parameters:
  - id: 4wxKNj49tQd5VwDRenYCf
    key: title
  - id: AKk5OVwjtgTIyK4A0BuwL
    key: content
  - id: 4746tJw8DEolxDReDgJTD
    key: translate
    type: source
    source:
      variableFrom: tool
      agent:
        projectId: "475837658589822976"
        id: 20240806103620-Jb5qkf
        from: assistant
        parameters:
          title: "{{ title }}"
          content: "{{ content }}"
  - id: 3AOb0aslhPKfG5y2hefc7
    key: id
prompts:
  4-QxIZH6RBgYAmzSgRp7L:
    index: 0
    data:
      type: message
      data:
        id: 4-QxIZH6RBgYAmzSgRp7L
        role: user
        content: "{{ question }}"
outputVariables:
  - id: hxkznAtdGcUzwHQBv0hPB
    name: status
    description: 输出结果
    required: true
id: 20240806105335-fvtHsS
createdAt: 2024-08-06T02:53:35.783Z
updatedAt: 2024-08-06T02:53:35.783Z
createdBy: z2qaBKnrTUAobCcqGMbqAMFW5WHpYzL3Kub2D
updatedBy: z2qaBKnrTUAobCcqGMbqAMFW5WHpYzL3Kub2D
name: 上传 翻译
model: gpt-4o-mini
prompt: "{{question}}"
code: |
  const fns = (translate?.list || []).map(async (i) => {
    const result = await call({
      name: 'did-comments',
      path: joinURL('api/call/posts', id, 'translations'),
      method: 'POST',
      data: {
        title: i.translated_title || '',
        content: (i.translated_content || '').replace(/\\n/g, '\n'),
        locale: i.language,
      },
      headers: context.getUserHeader(),
    });

    return result.data;
  });

  await Promise.all(fns);

  return { status: 'success' };
